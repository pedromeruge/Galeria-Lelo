@using app.Components.ClassBlocks.AuctionCard;
@using System;
@inherits ComponentBase
@inject NavigationManager NavigationManager

<div class="card-component" @onclick=" () => NavigateToDetalhesLeilao(Card.IdLeilao)">
  @if (Card.Images.Any()) {
    <img src="@Card.Images.First().Path" class="card-img-top" alt="@Card.Images.First().Path">
  }
  else {
    <p class="card-img-top">@Card.Images.First().Path</p>
  }
  <div class="info-names">
    <span>
      <span class="author">
        @Card.Nome_artista -
      </span>
      <span class="name">
        @Card.Prod_nome
      </span>
    </span>
  </div>
  <div class="info-bids">
    <div class="left-bid-text"> Licitação atual:</div>
    <div class="right-bid-text"> 
      <div class="preco-base">@Card.Preco_base €</div>
      <div class="preco-com-envio"> @finalCost € incl.</div>
    </div>
  </div>
  <div class="time">TODO: FIX DATA</div>
</div>

@code {
  [Parameter, EditorRequired]
  public AuctionCard Card { get; set; } = default!;
  private float finalCost;

  protected override void OnInitialized()
  {
      // Pegar na maior licitação atual, tem de se mudar ainda
      finalCost = Card.Preco_base + Card.Custo_envio;
  }

  private void NavigateToDetalhesLeilao(int auctionId) {
    NavigationManager.NavigateTo($"/AuctionDetails/{Card.IdLeilao}"); 
  }
}